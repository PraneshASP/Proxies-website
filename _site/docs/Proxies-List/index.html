

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  

  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">


  <link rel="stylesheet" href="/assets/css/just-the-docs-default.css">

  

  
    <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script>
  

  
    <script src="https://cdn.jsdelivr.net/npm/mermaid@9.1.6/dist/mermaid.min.js"></script>
  

  <script type="text/javascript" src="/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Full List of Proxy Types | yAcademy Proxies Research</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Full List of Proxy Types" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Proxies Research Compilation" />
<meta property="og:description" content="Proxies Research Compilation" />
<link rel="canonical" href="http://localhost:4000/docs/Proxies-List/" />
<meta property="og:url" content="http://localhost:4000/docs/Proxies-List/" />
<meta property="og:site_name" content="yAcademy Proxies Research" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Full List of Proxy Types" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Proxies Research Compilation","headline":"Full List of Proxy Types","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/images/yacademy-logo.png"}},"url":"http://localhost:4000/docs/Proxies-List/"}</script>
<!-- End Jekyll SEO tag -->


  

</head>

<body>
  <a class="skip-to-main" href="#main-content">Skip to main content</a>
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="svg-link" viewBox="0 0 24 24">
      <title>Link</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
      </svg>
    </symbol>
    <symbol id="svg-search" viewBox="0 0 24 24">
      <title>Search</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
        <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
      </svg>
    </symbol>
    <symbol id="svg-menu" viewBox="0 0 24 24">
      <title>Menu</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
        <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </symbol>
    <symbol id="svg-arrow-right" viewBox="0 0 24 24">
      <title>Expand</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
        <polyline points="9 18 15 12 9 6"></polyline>
      </svg>
    </symbol>
    <symbol id="svg-doc" viewBox="0 0 24 24">
      <title>Document</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
        <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
      </svg>
    </symbol>
    <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE -->
<symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link">
  <title id="svg-external-link-title">(external link)</title>
  <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line>
</symbol>

  </svg>

  <div class="side-bar">
    <div class="site-header">
      <a href="/" class="site-title lh-tight">
  <div class="site-logo"></div>

</a>
      <a href="#" id="menu-button" class="site-button">
        <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg>
      </a>
    </div>
    <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
      
      
        <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">yAcademy Proxies Research</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander" aria-label="toggle links in Full List of Proxy Types category">
            <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg>
          </a><a href="/docs/Proxies-List/" class="nav-list-link active">Full List of Proxy Types</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/Proxies-Storage/" class="nav-list-link">Proxies Storage</a></li><li class="nav-list-item "><a href="/docs/Delegatecall-with-selfdestruct/" class="nav-list-link">Delegatecall with Selfdestruct</a></li><li class="nav-list-item "><a href="/docs/Proxies-Table/" class="nav-list-link">Proxies Table</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in Security Guide to Proxy Vulns category">
            <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg>
          </a><a href="/docs/Security_Guide/" class="nav-list-link">Security Guide to Proxy Vulns</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/Proxy-Identification/" class="nav-list-link">Proxy Identification Flowchart</a></li></ul></li><li class="nav-list-item"><a href="/docs/Dev_Guide/" class="nav-list-link">Developer's Guide to Proxies</a></li><li class="nav-list-item external">
      <a href="https://yacademy.dev/" class="nav-list-link external">
        yAcademy Website
        <svg viewBox="0 0 24 24" aria-labelledby="svg-external-link-title"><use xlink:href="#svg-external-link"></use></svg>
      </a>
    </li></ul>
      
      
    </nav>

    
    
      <footer class="site-footer">
        <!-- This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. -->
      </footer>
    
  </div>
  <div class="main" id="top">
    <div id="main-header" class="main-header">
      

        

        <div class="search">
          <div class="search-input-wrap">
            <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search yAcademy Proxies Research" aria-label="Search yAcademy Proxies Research" autocomplete="off">
            <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
          </div>
          <div id="search-results" class="search-results"></div>
        </div>
      
      
      
    </div>
    <div id="main-content-wrap" class="main-content-wrap">
      
        
      
      <div id="main-content" class="main-content" role="main">
        
          <h2 class="no_toc text-delta" id="table-of-contents">
        
        
          <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents
        
        
      </h2>
    

<ol id="markdown-toc">
  <li><a href="#the-proxy" id="markdown-toc-the-proxy">The Proxy</a>    <ol>
      <li><a href="#use-cases" id="markdown-toc-use-cases">Use cases</a></li>
      <li><a href="#pros" id="markdown-toc-pros">Pros</a></li>
      <li><a href="#cons" id="markdown-toc-cons">Cons</a></li>
      <li><a href="#examples" id="markdown-toc-examples">Examples</a></li>
      <li><a href="#known-vulnerabilities" id="markdown-toc-known-vulnerabilities">Known vulnerabilities</a></li>
      <li><a href="#variations" id="markdown-toc-variations">Variations</a></li>
      <li><a href="#further-reading" id="markdown-toc-further-reading">Further reading</a></li>
    </ol>
  </li>
  <li><a href="#the-initializeable-proxy" id="markdown-toc-the-initializeable-proxy">The Initializeable Proxy</a>    <ol>
      <li><a href="#use-cases-1" id="markdown-toc-use-cases-1">Use cases</a></li>
      <li><a href="#pros-1" id="markdown-toc-pros-1">Pros</a></li>
      <li><a href="#cons-1" id="markdown-toc-cons-1">Cons</a></li>
      <li><a href="#examples-1" id="markdown-toc-examples-1">Examples</a></li>
      <li><a href="#known-vulnerabilities-1" id="markdown-toc-known-vulnerabilities-1">Known vulnerabilities</a></li>
      <li><a href="#variations-1" id="markdown-toc-variations-1">Variations</a></li>
      <li><a href="#further-reading-1" id="markdown-toc-further-reading-1">Further reading</a></li>
    </ol>
  </li>
  <li><a href="#the-upgradeable-proxy" id="markdown-toc-the-upgradeable-proxy">The Upgradeable Proxy</a>    <ol>
      <li><a href="#use-cases-2" id="markdown-toc-use-cases-2">Use cases</a></li>
      <li><a href="#pros-2" id="markdown-toc-pros-2">Pros</a></li>
      <li><a href="#cons-2" id="markdown-toc-cons-2">Cons</a></li>
      <li><a href="#examples-2" id="markdown-toc-examples-2">Examples</a></li>
      <li><a href="#known-vulnerabilities-2" id="markdown-toc-known-vulnerabilities-2">Known vulnerabilities</a></li>
      <li><a href="#further-reading-2" id="markdown-toc-further-reading-2">Further reading</a></li>
    </ol>
  </li>
  <li><a href="#eip-1967-upgradeable-proxy" id="markdown-toc-eip-1967-upgradeable-proxy">EIP-1967 Upgradeable Proxy</a>    <ol>
      <li><a href="#use-cases-3" id="markdown-toc-use-cases-3">Use cases</a></li>
      <li><a href="#pros-3" id="markdown-toc-pros-3">Pros</a></li>
      <li><a href="#cons-3" id="markdown-toc-cons-3">Cons</a></li>
      <li><a href="#examples-3" id="markdown-toc-examples-3">Examples</a></li>
      <li><a href="#known-vulnerabilities-3" id="markdown-toc-known-vulnerabilities-3">Known vulnerabilities</a></li>
      <li><a href="#further-reading-3" id="markdown-toc-further-reading-3">Further reading</a></li>
    </ol>
  </li>
  <li><a href="#the-proxy-delegate" id="markdown-toc-the-proxy-delegate">The Proxy Delegate</a></li>
  <li><a href="#transparent-proxy-tpp" id="markdown-toc-transparent-proxy-tpp">Transparent Proxy (TPP)</a>    <ol>
      <li><a href="#use-cases-4" id="markdown-toc-use-cases-4">Use cases</a></li>
      <li><a href="#pros-4" id="markdown-toc-pros-4">Pros</a></li>
      <li><a href="#cons-4" id="markdown-toc-cons-4">Cons</a></li>
      <li><a href="#examples-4" id="markdown-toc-examples-4">Examples</a></li>
      <li><a href="#known-vulnerabilities-4" id="markdown-toc-known-vulnerabilities-4">Known vulnerabilities</a></li>
      <li><a href="#further-reading-4" id="markdown-toc-further-reading-4">Further reading</a></li>
    </ol>
  </li>
  <li><a href="#universal-upgradeable-proxy-standard-uups" id="markdown-toc-universal-upgradeable-proxy-standard-uups">Universal Upgradeable Proxy Standard (UUPS)</a>    <ol>
      <li><a href="#use-cases-5" id="markdown-toc-use-cases-5">Use cases</a></li>
      <li><a href="#pros-5" id="markdown-toc-pros-5">Pros</a></li>
      <li><a href="#cons-5" id="markdown-toc-cons-5">Cons</a></li>
      <li><a href="#examples-5" id="markdown-toc-examples-5">Examples</a></li>
      <li><a href="#known-vulnerabilities-5" id="markdown-toc-known-vulnerabilities-5">Known vulnerabilities</a></li>
      <li><a href="#further-reading-5" id="markdown-toc-further-reading-5">Further reading</a></li>
    </ol>
  </li>
  <li><a href="#beacon-proxy" id="markdown-toc-beacon-proxy">Beacon Proxy</a>    <ol>
      <li><a href="#contract-verification" id="markdown-toc-contract-verification">Contract Verification</a></li>
      <li><a href="#use-cases-6" id="markdown-toc-use-cases-6">Use cases</a></li>
      <li><a href="#pros-6" id="markdown-toc-pros-6">Pros</a></li>
      <li><a href="#cons-6" id="markdown-toc-cons-6">Cons</a></li>
      <li><a href="#examples-6" id="markdown-toc-examples-6">Examples</a></li>
      <li><a href="#known-vulnerabilities-6" id="markdown-toc-known-vulnerabilities-6">Known vulnerabilities</a></li>
      <li><a href="#variations-2" id="markdown-toc-variations-2">Variations</a></li>
      <li><a href="#further-reading-6" id="markdown-toc-further-reading-6">Further reading</a></li>
    </ol>
  </li>
  <li><a href="#diamond-proxy" id="markdown-toc-diamond-proxy">Diamond Proxy</a>    <ol>
      <li><a href="#contract-verification-1" id="markdown-toc-contract-verification-1">Contract Verification</a></li>
      <li><a href="#use-cases-7" id="markdown-toc-use-cases-7">Use cases</a></li>
      <li><a href="#pros-7" id="markdown-toc-pros-7">Pros</a></li>
      <li><a href="#cons-7" id="markdown-toc-cons-7">Cons</a></li>
      <li><a href="#examples-7" id="markdown-toc-examples-7">Examples</a></li>
      <li><a href="#known-vulnerabilities-7" id="markdown-toc-known-vulnerabilities-7">Known vulnerabilities</a></li>
      <li><a href="#variations-3" id="markdown-toc-variations-3">Variations</a></li>
      <li><a href="#further-reading-7" id="markdown-toc-further-reading-7">Further reading</a></li>
    </ol>
  </li>
  <li><a href="#metamorphic-contracts" id="markdown-toc-metamorphic-contracts">Metamorphic Contracts</a>    <ol>
      <li><a href="#contract-verification-2" id="markdown-toc-contract-verification-2">Contract Verification</a></li>
      <li><a href="#use-cases-8" id="markdown-toc-use-cases-8">Use cases</a></li>
      <li><a href="#pros-8" id="markdown-toc-pros-8">Pros</a></li>
      <li><a href="#cons-8" id="markdown-toc-cons-8">Cons</a></li>
      <li><a href="#examples-8" id="markdown-toc-examples-8">Examples</a></li>
      <li><a href="#known-vulnerabilities-8" id="markdown-toc-known-vulnerabilities-8">Known vulnerabilities</a></li>
      <li><a href="#further-reading-8" id="markdown-toc-further-reading-8">Further reading</a></li>
    </ol>
  </li>
</ol>
      <h2 id="the-proxy">
        
        
          <a href="#the-proxy" class="anchor-heading" aria-labelledby="the-proxy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The Proxy
        
        
      </h2>
    

<blockquote>
  <p>And Vitalik said, “Let there be Proxies!”</p>
</blockquote>

<p>The proxy itself is not inherantly upgradeable, but it is the basis for just about all upgradeable proxy patterns.  Calls made to the <strong>proxy</strong> contract are forwarded to the <strong>implementation</strong> contract using <code class="language-plaintext highlighter-rouge">delegatecall</code>.</p>

<p>In some variants, calls to the proxy are only forwarded if the caller matches an “owner” address.</p>

<p><strong>Implementation address</strong> - Immutable in the proxy contract.</p>

<p><strong>Upgrade logic</strong> - There is no upgradeability in a pure proxy contract.</p>

<p><strong>Contract verification</strong> - Works with Etherscan (<a href="(https://etherscan.io/address/0x09cabec1ead1c0ba254b09efb3ee13841712be14#readProxyContract)">example</a>) and other block explorers.</p>
      <h3 id="use-cases">
        
        
          <a href="#use-cases" class="anchor-heading" aria-labelledby="use-cases"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Use cases
        
        
      </h3>
    
<ul>
  <li>Useful when there is a need to deploy multiple contracts whose code is more or less the same.</li>
</ul>
      <h3 id="pros">
        
        
          <a href="#pros" class="anchor-heading" aria-labelledby="pros"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Pros
        
        
      </h3>
    
<ul>
  <li>Inexpensive deployment.</li>
</ul>
      <h3 id="cons">
        
        
          <a href="#cons" class="anchor-heading" aria-labelledby="cons"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cons
        
        
      </h3>
    
<ul>
  <li>Adds a single <code class="language-plaintext highlighter-rouge">delegatecall</code> cost to each call.</li>
</ul>
      <h3 id="examples">
        
        
          <a href="#examples" class="anchor-heading" aria-labelledby="examples"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples
        
        
      </h3>
    
<ul>
  <li><a href="https://etherscan.io/address/0x09cabec1ead1c0ba254b09efb3ee13841712be14#code">Uniswap V1 AMM pools</a></li>
  <li><a href="https://github.com/Synthetixio/synthetix/pull/1191">Synthetix</a></li>
</ul>
      <h3 id="known-vulnerabilities">
        
        
          <a href="#known-vulnerabilities" class="anchor-heading" aria-labelledby="known-vulnerabilities"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Known vulnerabilities
        
        
      </h3>
    
<ul>
  <li><a href="https://github.com/YAcademy-Residents/Solidity-Proxy-Playground/blob/main/src/UUPS_functionCollision/UUPSProxy_functionCollission.t.sol">Delegatecall not allowed in implementation</a></li>
</ul>
      <h3 id="variations">
        
        
          <a href="#variations" class="anchor-heading" aria-labelledby="variations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Variations
        
        
      </h3>
    
<ul>
  <li><a href="https://eips.ethereum.org/EIPS/eip-1167">The EIP-1167 standard</a> was created in June ‘18 with the goal of standardizing a way to clone contract functionality simply, cheaply, and in an immutable way.  This standard contains a minimal bytecode redirect implementation that has been optimized for the proxy contract. This is often used with a <a href="https://github.com/optionality/clone-factory">factory pattern</a>.</li>
</ul>
      <h3 id="further-reading">
        
        
          <a href="#further-reading" class="anchor-heading" aria-labelledby="further-reading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Further reading
        
        
      </h3>
    
<ul>
  <li><a href="https://blog.originprotocol.com/a-minimal-proxy-in-the-wild-ae3f7b8da990">A Minimal Proxy in the Wild</a></li>
  <li><a href="https://docs.openzeppelin.com/contracts/4.x/api/proxy#Proxy">OpenZeppelin core Proxy contract</a></li>
  <li><a href="https://blog.openzeppelin.com/deep-dive-into-the-minimal-proxy-contract/">Deep dive into the Minimal Proxy contract</a></li>
</ul><hr />
      <h2 id="the-initializeable-proxy">
        
        
          <a href="#the-initializeable-proxy" class="anchor-heading" aria-labelledby="the-initializeable-proxy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The Initializeable Proxy
        
        
      </h2>
    

<blockquote>
  <p>“But what are we supposed to do without a <code class="language-plaintext highlighter-rouge">constructor()</code>?”</p>
</blockquote>

<p>Most modern day proxies are initializeable. One of the main benefits of using a proxy is that you only have to deploy the implementation contract once, and then you can deploy many proxy contracts that point at it. However, the downside to this is that you cannot use a constructor in the already deployed implementaion contract when creating the new proxy.</p>

<p>Instead, an <code class="language-plaintext highlighter-rouge">initialize()</code> function is used to set initial storage values:</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kt">uint8</span> <span class="k">private</span> <span class="n">_initialized</span><span class="p">;</span>

    <span class="k">function</span> <span class="n">initializer</span><span class="p">()</span> <span class="k">external</span> <span class="p">{</span>
        <span class="nb">require</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span> <span class="o">==</span> <span class="n">owner</span><span class="p">);</span>
        <span class="nb">require</span><span class="p">(</span><span class="n">_initialized</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">);</span>
        <span class="n">_initialized</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        
        <span class="c1">// set some state vars
</span>        <span class="c1">// do initialization stuff
</span>    <span class="p">}</span>

</code></pre></div></div>
      <h3 id="use-cases-1">
        
        
          <a href="#use-cases-1" class="anchor-heading" aria-labelledby="use-cases-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Use cases
        
        
      </h3>
    
<ul>
  <li>Most proxies with any kind of storage that needs to be set upon proxy contract deployment.</li>
</ul>
      <h3 id="pros-1">
        
        
          <a href="#pros-1" class="anchor-heading" aria-labelledby="pros-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Pros
        
        
      </h3>
    
<ul>
  <li>Allows initial storage to be set at time of new proxy deployment.</li>
</ul>
      <h3 id="cons-1">
        
        
          <a href="#cons-1" class="anchor-heading" aria-labelledby="cons-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cons
        
        
      </h3>
    
<ul>
  <li>Susceptible to attacks related to initialization, especially uninitialized proxies.</li>
</ul>
      <h3 id="examples-1">
        
        
          <a href="#examples-1" class="anchor-heading" aria-labelledby="examples-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples
        
        
      </h3>
    
<ul>
  <li>This feature is used with most modern proxy types including TPP and UUPS, except for use cases where there is no need to set storage upon proxy deployment.</li>
</ul>
      <h3 id="known-vulnerabilities-1">
        
        
          <a href="#known-vulnerabilities-1" class="anchor-heading" aria-labelledby="known-vulnerabilities-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Known vulnerabilities
        
        
      </h3>
    
<ul>
  <li><a href="https://github.com/YAcademy-Residents/Solidity-Proxy-Playground/tree/main/src/UUPS_Uninitialized">Uninitialized proxy</a></li>
</ul>
      <h3 id="variations-1">
        
        
          <a href="#variations-1" class="anchor-heading" aria-labelledby="variations-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Variations
        
        
      </h3>
    
<ul>
  <li><a href="https://github.com/optionality/clone-factory">Clone factory contract model</a> - uses clone initialization in a creation transaction.</li>
  <li><a href="https://github.com/wighawag/clones-with-immutable-args">Clones with Immutable Args</a> - enables creating clone contracts with immutable arguments which are stored in the code region of the proxy contract. When called, arguments are appended to the calldata of the <code class="language-plaintext highlighter-rouge">delegatecall</code>,  Implementation contract function then reads the arguments from calldata.  This pattern can remove the need to use an intializer but the downside is that currently <a href="https://twitter.com/boredGenius/status/1484713577961250821?s=20&amp;t=5jbuvNruLIJlLRow1nKrMw">the contract cannot be verified on Etherscan</a>.</li>
</ul>
      <h3 id="further-reading-1">
        
        
          <a href="#further-reading-1" class="anchor-heading" aria-labelledby="further-reading-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Further reading
        
        
      </h3>
    
<ul>
  <li><a href="https://ethereum-blockchain-developer.com/110-upgrade-smart-contracts/05-proxy-nick-johnson/">The First Proxy Contract</a></li>
  <li><a href="https://docs.openzeppelin.com/upgrades-plugins/1.x/writing-upgradeable">Writing Upgradeable Contracts</a></li>
</ul><hr />
      <h2 id="the-upgradeable-proxy">
        
        
          <a href="#the-upgradeable-proxy" class="anchor-heading" aria-labelledby="the-upgradeable-proxy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The Upgradeable Proxy
        
        
      </h2>
    

<blockquote>
  <p>And the people said, “But we want to upgrade our immutable contracts!”</p>
</blockquote>

<p>The Upgradeable Proxy is similar to a <a href="#The-Proxy">Proxy</a>, except the implementation contract address is settable and kept in storage in the proxy contract. The proxy contract also contains permissioned upgrade functions. One of the <a href="https://gist.github.com/Arachnid/4ca9da48d51e23e5cfe0f0e14dd6318f">first upgradeable proxy contracts</a> was written by <a href="https://twitter.com/nicksdjohnson">Nick Johnson</a> in 2016.</p>

<p>For security, it is also recommended to use a form of access control to differentiate between the owner/caller and the admin with permission to upgrade the contract.</p>

<p><strong>Implementation address</strong> - Located in proxy storage.</p>

<p><strong>Upgrade logic</strong> - Located in the proxy contract.</p>

<p><strong>Contract verification</strong> - Depending on the exact implementation, it may not work with block explorers like Etherscan.</p>
      <h3 id="use-cases-2">
        
        
          <a href="#use-cases-2" class="anchor-heading" aria-labelledby="use-cases-2"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Use cases
        
        
      </h3>
    
<ul>
  <li>A minimalistic upgrade contract. Useful for learning projects.</li>
</ul>
      <h3 id="pros-2">
        
        
          <a href="#pros-2" class="anchor-heading" aria-labelledby="pros-2"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Pros
        
        
      </h3>
    
<ul>
  <li>Reduced deployment costs through use of the <a href="#The-proxy">Proxy</a>.</li>
  <li>Implementation contract is upgradeable.</li>
</ul>
      <h3 id="cons-2">
        
        
          <a href="#cons-2" class="anchor-heading" aria-labelledby="cons-2"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cons
        
        
      </h3>
    
<ul>
  <li>Prone to storage and function collisions.</li>
  <li>Less secure than modern counterparts.</li>
  <li>Every call incurs cost of <code class="language-plaintext highlighter-rouge">delegatecall</code> from the <a href="#The-Proxy">Proxy</a>.</li>
</ul>
      <h3 id="examples-2">
        
        
          <a href="#examples-2" class="anchor-heading" aria-labelledby="examples-2"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples
        
        
      </h3>
    
<ul>
  <li>This basic style is not widely used anymore.</li>
</ul>
      <h3 id="known-vulnerabilities-2">
        
        
          <a href="#known-vulnerabilities-2" class="anchor-heading" aria-labelledby="known-vulnerabilities-2"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Known vulnerabilities
        
        
      </h3>
    
<ul>
  <li><a href="https://github.com/YAcademy-Residents/Solidity-Proxy-Playground/blob/main/src/UUPS_functionCollision/UUPSProxy_functionCollission.t.sol">Delegatecall not allowed in implementation</a></li>
  <li><a href="https://github.com/YAcademy-Residents/Solidity-Proxy-Playground/tree/main/src/UUPS_Uninitialized">Uninitialized proxy</a></li>
  <li><a href="https://github.com/YAcademy-Residents/Solidity-Proxy-Playground/blob/main/src/TransparentProxy_storageCollision/TransparentProxy_storageCollissionHack.t.sol">Storage collision</a></li>
  <li><a href="https://github.com/YAcademy-Residents/Solidity-Proxy-Playground/blob/main/src/UpgradeableProxy_functionCollission/UpgradeableProxy_functionCollissionHack.t.sol">Function collision</a></li>
</ul>
      <h3 id="further-reading-2">
        
        
          <a href="#further-reading-2" class="anchor-heading" aria-labelledby="further-reading-2"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Further reading
        
        
      </h3>
    
<ul>
  <li><a href="https://ethereum-blockchain-developer.com/110-upgrade-smart-contracts/05-proxy-nick-johnson/">The First Proxy Contract</a></li>
  <li><a href="https://docs.openzeppelin.com/upgrades-plugins/1.x/writing-upgradeable">Writing Upgradeable Contracts</a></li>
</ul><hr />
      <h2 id="eip-1967-upgradeable-proxy">
        
        
          <a href="#eip-1967-upgradeable-proxy" class="anchor-heading" aria-labelledby="eip-1967-upgradeable-proxy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> EIP-1967 Upgradeable Proxy
        
        
      </h2>
    

<blockquote>
  <p>The “solution” to storage collisions</p>
</blockquote>

<p>This is similar to the <a href="#The-Upgradeable-Proxy">Upgradeable Proxy</a>, except that it reduces risk of storage collision by using the <a href="https://docs.openzeppelin.com/upgrades-plugins/1.x/proxies#unstructured-storage-proxies">unstructured storage pattern</a>. It does <strong>not</strong> store the implementation contract address in slot 0 or any other standard storage slot.  Instead the address is stored in a pre-agreed upon slot (for example <strong><em>0x360894…ca505d382bbc</em></strong> in <a href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/v4.7.3/contracts/proxy/ERC1967/ERC1967Upgrade.sol">OpenZeppelin contracts</a>) which has the added benefit of allowing block explorers to verify the contracts and properly show this information to end users.</p>

<p><a href="https://eips.ethereum.org/EIPS/eip-1967">EIP-1967</a> also specifies a slot for admin storage (auth) as well as Beacon Proxies which will be discussed in detail below.</p>

<p><strong>Implementation address</strong> - Located in a unique storage slot in the proxy contract.</p>

<p><strong>Upgrade logic</strong> - Varies based on implementation.</p>

<p><strong>Contract verification</strong> - Yes, most evm block explorers support it.</p>
      <h3 id="use-cases-3">
        
        
          <a href="#use-cases-3" class="anchor-heading" aria-labelledby="use-cases-3"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Use cases
        
        
      </h3>
    
<ul>
  <li>When you need more security than the basic <a href="#The-Upgradeable-Proxy">Upgradeable Proxy</a>.</li>
</ul>
      <h3 id="pros-3">
        
        
          <a href="#pros-3" class="anchor-heading" aria-labelledby="pros-3"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Pros
        
        
      </h3>
    
<ul>
  <li>Reduces risk of storage collisions.</li>
  <li>Block explorer compatibility</li>
</ul>
      <h3 id="cons-3">
        
        
          <a href="#cons-3" class="anchor-heading" aria-labelledby="cons-3"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cons
        
        
      </h3>
    
<ul>
  <li>Susceptible to function collisions.</li>
  <li>Less secure than modern counterparts.</li>
  <li>Every call incurs cost of <code class="language-plaintext highlighter-rouge">delegatecall</code> from the <a href="#The-Proxy">Proxy</a>.</li>
</ul>
      <h3 id="examples-3">
        
        
          <a href="#examples-3" class="anchor-heading" aria-labelledby="examples-3"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples
        
        
      </h3>
    
<ul>
  <li>While the EIP-1967 storage slot pattern has been widely adopted in most modern upgradeable proxy types, this bare bones contract is not seen in the wild as much as some of the newer patterns like Beacon, TPP and UUPS.</li>
</ul>
      <h3 id="known-vulnerabilities-3">
        
        
          <a href="#known-vulnerabilities-3" class="anchor-heading" aria-labelledby="known-vulnerabilities-3"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Known vulnerabilities
        
        
      </h3>
    
<ul>
  <li><a href="https://github.com/YAcademy-Residents/Solidity-Proxy-Playground/tree/main/src/UUPS_Uninitialized">Uninitialized proxy</a></li>
  <li><a href="https://github.com/YAcademy-Residents/Solidity-Proxy-Playground/blob/main/src/UpgradeableProxy_functionCollission/UpgradeableProxy_functionCollissionHack.t.sol">Function collision</a></li>
</ul>
      <h3 id="further-reading-3">
        
        
          <a href="#further-reading-3" class="anchor-heading" aria-labelledby="further-reading-3"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Further reading
        
        
      </h3>
    
<ul>
  <li><a href="https://ethereum-blockchain-developer.com/110-upgrade-smart-contracts/09-eip-1967/">EIP-1967 Standard Proxy Storage Slots</a></li>
  <li>
      <h2 id="the-proxy-delegate">
        
        
          <a href="#the-proxy-delegate" class="anchor-heading" aria-labelledby="the-proxy-delegate"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a href="https://fravoll.github.io/solidity-patterns/proxy_delegate.html">The Proxy Delegate</a>
        
        
      </h2>
    
  </li>
</ul>
      <h2 id="transparent-proxy-tpp">
        
        
          <a href="#transparent-proxy-tpp" class="anchor-heading" aria-labelledby="transparent-proxy-tpp"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Transparent Proxy (TPP)
        
        
      </h2>
    

<blockquote>
  <p>The “solution” to function collisions</p>
</blockquote>

<p>This is similar to the <a href="#The-Upgradeable-Proxy">Upgradeable Proxy</a> and usually incorporates <a href="#EIP-1967-Upgradeable-Proxy">EIP-1967</a>, but when the permissioned functions are called, if admin is the caller then those functions are invoked directly on the proxy, otherwise the call is forwarded to the implementation contract. This is often implemented with a modifier like this one from <a href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/proxy/transparent/TransparentUpgradeableProxy.sol#L45-L51">OpenZeppelin</a>:</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">modifier</span> <span class="n">ifAdmin</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span> <span class="o">==</span> <span class="n">_getAdmin</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">_</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">_fallback</span><span class="p">();</span> <span class="c1">// redirects call to proxy
</span>    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Implementation address</strong> - Located in a unique storage slot in the proxy contract (<a href="#EIP-1967-Proxy">EIP-1967</a>).</p>

<p><strong>Upgrade logic</strong> - Located in the proxy contract with use of a <a href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/proxy/transparent/TransparentUpgradeableProxy.sol#L45-L51">modifier</a> to re-route non-admin callers.</p>

<p><strong>Contract verification</strong> - Yes, most evm block explorers support it.</p>
      <h3 id="use-cases-4">
        
        
          <a href="#use-cases-4" class="anchor-heading" aria-labelledby="use-cases-4"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Use cases
        
        
      </h3>
    
<ul>
  <li>This pattern is very widely used for its upgradeability and protections against certain function and storage collision vulnerabilities.</li>
</ul>
      <h3 id="pros-4">
        
        
          <a href="#pros-4" class="anchor-heading" aria-labelledby="pros-4"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Pros
        
        
      </h3>
    
<ul>
  <li>Block explorer compatibility.</li>
  <li>Reduces risk of function collisions due to <a href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/proxy/transparent/TransparentUpgradeableProxy.sol#L45-L51">ifAdmin() </a> modifier.</li>
  <li>Reduces risk of storage collisions from use of <a href="#EIP-1967-Upgradeable-Proxy">EIP-1967</a> storage slots.</li>
</ul>
      <h3 id="cons-4">
        
        
          <a href="#cons-4" class="anchor-heading" aria-labelledby="cons-4"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cons
        
        
      </h3>
    
<ul>
  <li>Considered by some to be less secure than <a href="#Universal-Upgradeable-Proxy-Standard-(UUPS)">UUPS</a>.</li>
  <li>Every call incurs cost of <code class="language-plaintext highlighter-rouge">delegatecall</code> from the <a href="#The-Proxy">Proxy</a>.</li>
</ul>
      <h3 id="examples-4">
        
        
          <a href="#examples-4" class="anchor-heading" aria-labelledby="examples-4"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples
        
        
      </h3>
    
<ul>
  <li><a href="https://github.com/dydxprotocol/perpetual/blob/99962cc62caed2376596da357a13f5c3d0ea5e59/contracts/protocol/PerpetualProxy.sol">dYdX</a></li>
  <li><a href="https://github.com/centrehq/centre-tokens/tree/b42cf04b31639b8b05d53fea9995954d5f3659d9/contracts/upgradeability">USDC</a></li>
  <li><a href="https://github.com/AztecProtocol/AZTEC/blob/cb78ba3ee32ad82234ac0fbed046333eb7f233cf/packages/protocol/contracts/AccountRegistry/AccountRegistryManager.sol#L62-L66">Aztec</a></li>
  <li><a href="https://github.com/search?q=adminupgradeabilityproxy&amp;type=Code">Hundreds of projects on Github</a></li>
</ul>
      <h3 id="known-vulnerabilities-4">
        
        
          <a href="#known-vulnerabilities-4" class="anchor-heading" aria-labelledby="known-vulnerabilities-4"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Known vulnerabilities
        
        
      </h3>
    
<ul>
  <li><a href="https://github.com/YAcademy-Residents/Solidity-Proxy-Playground/blob/main/src/UUPS_functionCollision/UUPSProxy_functionCollission.t.sol">Delegatecall not allowed in implementation</a></li>
  <li><a href="https://github.com/YAcademy-Residents/Solidity-Proxy-Playground/tree/main/src/UUPS_Uninitialized">Uninitialized proxy</a></li>
  <li><a href="https://github.com/YAcademy-Residents/Solidity-Proxy-Playground/blob/main/src/TransparentProxy_storageCollision/TransparentProxy_storageCollissionHack.t.sol">Storage collision</a></li>
</ul>
      <h3 id="further-reading-4">
        
        
          <a href="#further-reading-4" class="anchor-heading" aria-labelledby="further-reading-4"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Further reading
        
        
      </h3>
    
<ul>
  <li><a href="https://blog.openzeppelin.com/the-transparent-proxy-pattern/">The Transparent Proxy Pattern</a></li>
</ul><hr />
      <h2 id="universal-upgradeable-proxy-standard-uups">
        
        
          <a href="#universal-upgradeable-proxy-standard-uups" class="anchor-heading" aria-labelledby="universal-upgradeable-proxy-standard-uups"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Universal Upgradeable Proxy Standard (UUPS)
        
        
      </h2>
    

<blockquote>
  <p>What if we move the upgrade logic to the impl contract? 🤔</p>
</blockquote>

<p>EIP-1822 describes a standard for an upgradeable proxy pattern where the <code class="language-plaintext highlighter-rouge">upgrade</code> logic is stored in the implementation contract.  This way, there is no need to check if the caller is admin in the proxy (saving gas) at the proxy level, saving gas.  It also eliminates the possibility of a function on the implementation contract colliding with the upgrade logic in the proxy.</p>

<p>The UUPS proxy also contains a check when upgrading that ensures the new implementation contract is upgradeable.</p>

<p>This proxy contract usually incorporates <a href="#EIP-1967-Upgradeable-Proxy">EIP-1967</a>.</p>

<p><strong>Implementation address</strong> - Located in a unique storage slot in the proxy contract (<a href="#EIP-1967-Proxy">EIP-1967</a>).</p>

<p><strong>Upgrade logic</strong> - Located in the implementation contract.</p>

<p><strong>Contract verification</strong> - Yes, most evm block explorers support it.</p>
      <h3 id="use-cases-5">
        
        
          <a href="#use-cases-5" class="anchor-heading" aria-labelledby="use-cases-5"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Use cases
        
        
      </h3>
    
<ul>
  <li>These days this is the most widely used pattern when protocols look to deploy upgradeable contracts.</li>
</ul>
      <h3 id="pros-5">
        
        
          <a href="#pros-5" class="anchor-heading" aria-labelledby="pros-5"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Pros
        
        
      </h3>
    
<ul>
  <li>Eliminates risk of functions on the implementation contract colliding with the proxy contract since that logic lives on the implementation contract.</li>
  <li>Reduces risk of storage collisions from use of <a href="#EIP-1967-Upgradeable-Proxy">EIP-1967</a> storage slots.</li>
</ul>
      <h3 id="cons-5">
        
        
          <a href="#cons-5" class="anchor-heading" aria-labelledby="cons-5"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cons
        
        
      </h3>
    
<ul>
  <li>Somewhat more complex and more overhead than other proxy types.</li>
  <li>Every call incurs cost of <code class="language-plaintext highlighter-rouge">delegatecall</code> from the <a href="#The-Proxy">Proxy</a>.</li>
</ul>
      <h3 id="examples-5">
        
        
          <a href="#examples-5" class="anchor-heading" aria-labelledby="examples-5"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples
        
        
      </h3>
    
<ul>
  <li><a href="https://github.com/superfluid-finance/protocol-monorepo">Superfluid</a></li>
  <li><a href="https://github.com/Synthetixio/synthetix-v3">Synthetix</a></li>
  <li><a href="https://github.com/search?q=UUPSUpgradeable&amp;type=code">Hundreds of projects on Github</a></li>
</ul>
      <h3 id="known-vulnerabilities-5">
        
        
          <a href="#known-vulnerabilities-5" class="anchor-heading" aria-labelledby="known-vulnerabilities-5"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Known vulnerabilities
        
        
      </h3>
    
<ul>
  <li><a href="https://github.com/YAcademy-Residents/Solidity-Proxy-Playground/tree/main/src/UUPS_Uninitialized">Uninitialized proxy</a></li>
  <li><a href="https://github.com/YAcademy-Residents/Solidity-Proxy-Playground/tree/main/src/UUPS_functionCollision">Function collision</a></li>
  <li><a href="https://github.com/YAcademy-Residents/Solidity-Proxy-Playground/blob/main/test/UUPS_selfdestruct.t.sol">Selfdestruct</a></li>
</ul>
      <h3 id="further-reading-5">
        
        
          <a href="#further-reading-5" class="anchor-heading" aria-labelledby="further-reading-5"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Further reading
        
        
      </h3>
    
<ul>
  <li><a href="https://eips.ethereum.org/EIPS/eip-1822">EIP-1822</a></li>
  <li><a href="https://blog.logrocket.com/using-uups-proxy-pattern-upgrade-smart-contracts/">Using UUPS Proxy Pattern</a></li>
  <li><a href="https://iosiro.com/blog/openzeppelin-uups-proxy-vulnerability-disclosure">Perma-brick UUPS proxies with this one trick</a></li>
</ul><hr />
      <h2 id="beacon-proxy">
        
        
          <a href="#beacon-proxy" class="anchor-heading" aria-labelledby="beacon-proxy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Beacon Proxy
        
        
      </h2>
    

<blockquote>
  <p>Is that a beacon in your proxy or are you just happy to see me? 🤔</p>
</blockquote>

<p>Most proxies discussed so far store the implementation contract address in the proxy contract storage. The Beacon pattern, popularized by <a href="https://github.com/dharma-eng/dharma-smart-wallet/blob/master/contracts/proxies/smart-wallet/UpgradeBeaconProxyV1.sol">Dharma</a> in 2019, stores the address of the implementation contract in a separate “beacon” contract.  The address of the beacon is stored in the proxy contract.  To save gas, the proxy often stores the beacon address immutably.</p>

<p>With other types of proxies, when the implementation contract is upgraded, all of the proxies need to be updated.  However, with the Beacon proxy, only the beacon contract itself needs to be updated.</p>

<p>EIP-1967 also references a Beacon address slot.</p>
      <h5 id="contract-verification">
        
        
          <a href="#contract-verification" class="anchor-heading" aria-labelledby="contract-verification"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Contract Verification
        
        
      </h5>
    
<ul>
  <li>Yes, most evm block explorers support it.</li>
</ul>
      <h3 id="use-cases-6">
        
        
          <a href="#use-cases-6" class="anchor-heading" aria-labelledby="use-cases-6"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Use cases
        
        
      </h3>
    
<ul>
  <li>If you have a need for multiple proxy contracts that can all be upgraded at once by upgrading the Beacon.</li>
  <li>Appropriate for situations that involve large amounts of proxy contracts based on multiple implementation contracts.  The beacon proxy pattern enables updating various groups of proxies at the same time.</li>
</ul>
      <h3 id="pros-6">
        
        
          <a href="#pros-6" class="anchor-heading" aria-labelledby="pros-6"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Pros
        
        
      </h3>
    
<ul>
  <li>Easier to upgrade multiple proxy contracts at the same time.</li>
</ul>
      <h3 id="cons-6">
        
        
          <a href="#cons-6" class="anchor-heading" aria-labelledby="cons-6"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cons
        
        
      </h3>
    
<ul>
  <li>Gas overhead of getting the Beacon contract address from storage, calling Beacon contract, and then getting the implementation contract, plus the extra gas required by using a proxy.</li>
  <li>Adds additional complexity.</li>
</ul>
      <h3 id="examples-6">
        
        
          <a href="#examples-6" class="anchor-heading" aria-labelledby="examples-6"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples
        
        
      </h3>
    
<ul>
  <li><a href="https://polygonscan.com/address/0xb254554636a3ff52e8b2d0f06203921c137e10d5#code">USDC</a></li>
  <li><a href="https://github.com/dharma-eng/dharma-smart-wallet/blob/master/contracts/proxies/smart-wallet/UpgradeBeaconProxyV1.sol">Dharma</a></li>
</ul>
      <h3 id="known-vulnerabilities-6">
        
        
          <a href="#known-vulnerabilities-6" class="anchor-heading" aria-labelledby="known-vulnerabilities-6"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Known vulnerabilities
        
        
      </h3>
    
<ul>
  <li><a href="https://github.com/YAcademy-Residents/Solidity-Proxy-Playground/tree/main/src/UUPS_Uninitialized">Uninitialized proxy</a></li>
  <li><a href="https://github.com/YAcademy-Residents/Solidity-Proxy-Playground/tree/main/src/UUPS_functionCollision">Function collision</a></li>
</ul>
      <h3 id="variations-2">
        
        
          <a href="#variations-2" class="anchor-heading" aria-labelledby="variations-2"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Variations
        
        
      </h3>
    
<ul>
  <li><a href="https://forum.openzeppelin.com/t/a-more-gas-efficient-upgradeable-proxy-by-not-using-storage/4111">Storageless Upgradeable Beacon Proxy</a> - In this pattern, the beacon contract does not store the implementation contract address in storage, but instead stores it in code.  The proxy contract loads it from the proxy directly via <code class="language-plaintext highlighter-rouge">EXTCODECOPY</code>.</li>
</ul>
      <h3 id="further-reading-6">
        
        
          <a href="#further-reading-6" class="anchor-heading" aria-labelledby="further-reading-6"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Further reading
        
        
      </h3>
    
<ul>
  <li><a href="https://medium.com/coinmonks/how-to-create-a-beacon-proxy-3d55335f7353">How to create a Beacon Proxy</a></li>
  <li><a href="https://github.com/dharma-eng/dharma-smart-wallet/blob/master/contracts/proxies/smart-wallet/UpgradeBeaconProxyV1.sol">Dharma</a></li>
</ul><hr />
      <h2 id="diamond-proxy">
        
        
          <a href="#diamond-proxy" class="anchor-heading" aria-labelledby="diamond-proxy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Diamond Proxy
        
        
      </h2>
    

<blockquote>
  <p>“Diamonds are a proxy’s best friend?”</p>
</blockquote>

<p><a href="https://eips.ethereum.org/EIPS/eip-2535">EIP-2535</a> “Diamonds” are modular smart contract systems that can be upgraded/extended after deployment, and have virtually no size limit. From the EIP:</p>

<blockquote>
  <p>a diamond is a contract with external functions that are supplied by contracts called facets. Facets are separate, independent contracts that can share internal functions, libraries, and state variables.</p>
</blockquote>

<p>The diamond pattern consists of a central Diamond.sol proxy contract. In addition to other storage, this contract contains a registry of functions that can be called on external contracts called facets.</p>

<p>Glossary of Diamond proxy uses a unique vocabulary:</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>Diamond term</th>
      <th>Definition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Diamond</td>
      <td>Proxy</td>
    </tr>
    <tr>
      <td>Facet</td>
      <td>Implementation</td>
    </tr>
    <tr>
      <td>Cut</td>
      <td>Upgrade</td>
    </tr>
    <tr>
      <td>Loupe</td>
      <td>List of delegated functions</td>
    </tr>
    <tr>
      <td>Finished diamond</td>
      <td>Non-upgradeable</td>
    </tr>
    <tr>
      <td>Single cut diamond</td>
      <td>Remove upgradeability functions</td>
    </tr>
  </tbody>
</table></div>
      <h5 id="contract-verification-1">
        
        
          <a href="#contract-verification-1" class="anchor-heading" aria-labelledby="contract-verification-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Contract Verification
        
        
      </h5>
    
<ul>
  <li>Contracts can be verified on Etherscan with the help of a tool called <strong>Louper</strong> (<a href="https://louper.dev/diamond/0x17525e4f4af59fbc29551bc4ece6ab60ed49ce31">example</a>).</li>
</ul>
      <h3 id="use-cases-7">
        
        
          <a href="#use-cases-7" class="anchor-heading" aria-labelledby="use-cases-7"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Use cases
        
        
      </h3>
    
<ul>
  <li>A complex system where the highest level of upgradeability and modular interoperability is required.</li>
</ul>
      <h3 id="pros-7">
        
        
          <a href="#pros-7" class="anchor-heading" aria-labelledby="pros-7"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Pros
        
        
      </h3>
    
<ul>
  <li>A stable contract address that provides needed functionality. Emitting events from a single address can simplify event handling.</li>
  <li>Can be used to break up a large contract &gt; 24kb that is over the Spurious Dragon limit.</li>
</ul>
      <h3 id="cons-7">
        
        
          <a href="#cons-7" class="anchor-heading" aria-labelledby="cons-7"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cons
        
        
      </h3>
    
<ul>
  <li>Additional gas required to access storage when routing functions.</li>
  <li>Complexity may be too much when simple upgradeability is required.</li>
</ul>
      <h3 id="examples-7">
        
        
          <a href="#examples-7" class="anchor-heading" aria-labelledby="examples-7"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples
        
        
      </h3>
    
<ul>
  <li><a href="https://www.simpledefi.io/">Simple DeFi</a></li>
  <li><a href="https://party.finance/">PartyFinance</a></li>
  <li><a href="https://github.com/mudgen/awesome-diamonds#projects-using-diamonds">Complete list of examples</a>.</li>
</ul>
      <h3 id="known-vulnerabilities-7">
        
        
          <a href="#known-vulnerabilities-7" class="anchor-heading" aria-labelledby="known-vulnerabilities-7"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Known vulnerabilities
        
        
      </h3>
    
<ul>
  <li>No known vulnerabilities aside from the general risk associated with implementing patterns with any degree of complexity.</li>
</ul>
      <h3 id="variations-3">
        
        
          <a href="#variations-3" class="anchor-heading" aria-labelledby="variations-3"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Variations
        
        
      </h3>
    
<ul>
  <li><a href="https://github.com/OpenZeppelin/openzeppelin-labs/tree/master/upgradeability_with_vtable">vtable</a></li>
  <li><a href="https://twitter.com/ylv_io/status/1581639395064836102?s=20&amp;t=WoHhqaSl8SlEdLUje5Cziw">How to build unlimited size contracts</a></li>
</ul>
      <h3 id="further-reading-7">
        
        
          <a href="#further-reading-7" class="anchor-heading" aria-labelledby="further-reading-7"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Further reading
        
        
      </h3>
    
<ul>
  <li><a href="https://eip2535diamonds.substack.com/p/answering-some-diamond-questions">Answering some Diamond questions</a></li>
  <li><a href="https://blog.zkga.me/dark-forest-and-the-diamond-standard">Dark Forest and the Diamond standard </a></li>
  <li><a href="https://blog.trailofbits.com/2020/10/30/good-idea-bad-design-how-the-diamond-standard-falls-short/">Good idea, bad design. How the Diamond standard falls short</a></li>
  <li><a href="https://dev.to/mudgen/addressing-josselin-feist-s-concern-s-of-eip-2535-diamond-standard-me8">Addressing Josselin Feist’s Concern’s of EIP-2535 Diamonds</a></li>
</ul><hr />
      <h2 id="metamorphic-contracts">
        
        
          <a href="#metamorphic-contracts" class="anchor-heading" aria-labelledby="metamorphic-contracts"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metamorphic Contracts
        
        
      </h2>
    

<blockquote>
  <p>“create2, use, selfdestruct, rinse, repeat…”</p>
</blockquote>

<p>The metamorphic contract is unique from all the other upgradeable patterns in that it does NOT use a proxy. There is no <code class="language-plaintext highlighter-rouge">delegatecall</code> to an external logic contract.</p>

<p>When it’s time for an upgrade, the metamorphic contract uses <code class="language-plaintext highlighter-rouge">selfdestruct</code> and the new contract is deployed to the same address using <code class="language-plaintext highlighter-rouge">create2</code>.</p>

<p>This can be achieved by having the initcode retrieve the creation code from the storage of a separate external contract.  In this way, the initcode will always be the same, and therefore <code class="language-plaintext highlighter-rouge">create2</code> can be used to deploy to the same address.</p>
      <h5 id="contract-verification-2">
        
        
          <a href="#contract-verification-2" class="anchor-heading" aria-labelledby="contract-verification-2"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Contract Verification
        
        
      </h5>
    
<ul>
  <li>Yes, metamorphic contracts can be verified.</li>
</ul>
      <h3 id="use-cases-8">
        
        
          <a href="#use-cases-8" class="anchor-heading" aria-labelledby="use-cases-8"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Use cases
        
        
      </h3>
    
<ul>
  <li>Contracts that contain only logic (similar to Solidity external libraries)</li>
  <li>Contracts with little state that changes infrequently, such as beacons.</li>
</ul>
      <h3 id="pros-8">
        
        
          <a href="#pros-8" class="anchor-heading" aria-labelledby="pros-8"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Pros
        
        
      </h3>
    
<ul>
  <li>Does not require the use of a proxy with <code class="language-plaintext highlighter-rouge">delegatecall</code>.</li>
  <li>Does not require using an <code class="language-plaintext highlighter-rouge">initialize()</code> instead of a <code class="language-plaintext highlighter-rouge">constructor()</code>.`</li>
</ul>
      <h3 id="cons-8">
        
        
          <a href="#cons-8" class="anchor-heading" aria-labelledby="cons-8"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cons
        
        
      </h3>
    
<ul>
  <li>Storage is erased on upgrade because of <code class="language-plaintext highlighter-rouge">selfdestruct</code>.</li>
  <li>Because <code class="language-plaintext highlighter-rouge">selfdestruct</code> clears the code at the end of the transaction, an upgrade requires two transactions: one to delete the current contract, and another to create the new one. Any transaction that arrives to our contract in between those two would fail.</li>
  <li>The <code class="language-plaintext highlighter-rouge">selfdestruct</code> opcode may be removed in the future.</li>
</ul>
      <h3 id="examples-8">
        
        
          <a href="#examples-8" class="anchor-heading" aria-labelledby="examples-8"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples
        
        
      </h3>
    
<ul>
  <li>This is more of an experimental type. Mostly used by MEV searchers.</li>
</ul>
      <h3 id="known-vulnerabilities-8">
        
        
          <a href="#known-vulnerabilities-8" class="anchor-heading" aria-labelledby="known-vulnerabilities-8"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Known vulnerabilities
        
        
      </h3>
    
<ul>
  <li>Not vulnerable to the typical upgradeable proxy vulnerabilities since it doesn’t use a proxy or an initializer.</li>
  <li>May be vulnerable to attack at time of upgrade.</li>
</ul>
      <h3 id="further-reading-8">
        
        
          <a href="#further-reading-8" class="anchor-heading" aria-labelledby="further-reading-8"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Further reading
        
        
      </h3>
    
<ul>
  <li><a href="https://ethereum-blockchain-developer.com/110-upgrade-smart-contracts/12-metamorphosis-create2/">Metamorphosis Smart Contracts using CREATE2</a></li>
  <li><a href="https://0age.medium.com/the-promise-and-the-peril-of-metamorphic-contracts-9eb8b8413c5e">The Promise and the Peril of Metamorphic Contracts</a></li>
</ul>

        

        
          <hr>
          <h2 class="text-delta">Table of contents</h2>
          <ul>
            
              <li>
                <a href="/docs/Proxies-Storage/">Proxies Storage</a>
              </li>
            
              <li>
                <a href="/docs/Delegatecall-with-selfdestruct/">Delegatecall with Selfdestruct</a>
              </li>
            
              <li>
                <a href="/docs/Proxies-Table/">Proxies Table</a>
              </li>
            
          </ul>
        

        
        
          <hr>
          <footer>
            
              <p><a href="#top" id="back-to-top">Back to top</a></p>
            

            <p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2022 yAcademy</p>

            
              <div class="d-flex mt-2">
                
                
              </div>
            
          </footer>
        

      </div>
    </div>

    
      

      <div class="search-overlay"></div>
    
  </div>
</body>

  <script>
    var config = {}
;
    mermaid.initialize(config);
    window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid'));
  </script>

</html>

